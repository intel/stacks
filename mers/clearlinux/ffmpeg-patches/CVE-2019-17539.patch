From b0d55da9ea0111b5d265c41d739511f9bd608ed2 Mon Sep 17 00:00:00 2001
From: Luis Ponce <luis.f.ponce.navarro@linux.intel.com>
Date: Wed, 30 Oct 2019 13:56:59 -0600
Subject: [PATCH] avcodec/utils: Check close before calling it

Fixes: NULL pointer dereference
---
 libavcodec/utils.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libavcodec/utils.c b/libavcodec/utils.c
index e82cb43dbb..a0799480d9 100644
--- a/libavcodec/utils.c
+++ b/libavcodec/utils.c
@@ -1018,7 +1018,7 @@ end:
 
     return ret;
 free_and_end:
-    if (avctx->codec &&
+    if (avctx->codec && avctx->codec->close &&
         (avctx->codec->caps_internal & FF_CODEC_CAP_INIT_CLEANUP))
         avctx->codec->close(avctx);
 
-- 
2.22.0

